---
import "../styles/base.css";
import Layout from "../layouts/Layout.astro";

import { getCollection, getEntries } from "astro:content";

export async function getStaticPaths() {
  const milestones = await getCollection("milestones");
  return milestones.map((entry) => ({
    params: { milestone: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;

let items = await Promise.all(
  (await getEntries(entry.data.items)).map(async (item) => ({
    ...item,
    Content: await item.render(),
  })),
);
---

<Layout title="Swarm Roadmap">
  <main class="pt-12 text-[19px] leading-[26px] text-[#F6F7F9]">
    <div class="flex justify-center">
      <a href="https://www.ethswarm.org/"
        ><img src="/swarm.png" alt="" class="h-9" /></a
      >
    </div>

    <div
      class="grid grid-cols-12 gap-5 max-w-6xl mx-auto px-5 lg:px-8 pt-20 pb-12 md:pt-28 md:pb-24"
    >
      <div class="col-span-12 sm:col-span-6">
        <h1 class="text-[#F6F7F9] font-bold">
          <div class="text-3xl lg:text-5xl mb-3">
            Milestone {entry.data.index}
          </div>
          <div class="text-2xl lg:text-[32px] leading-tight">
            {entry.data.title}
          </div>
        </h1>

        <div class="mt-12">
          <a
            href="/"
            class="no-underline transition duration-200 inline-flex justify-center rounded-full items-center text-sm font-semibold leading-[2.3] whitespace-nowrap bg-[#FF6B26] focus:outline-none text-[#F6F7F9] hover:bg-opacity-80 px-4"
            >&lt;- All milestones</a
          >
        </div>
      </div>
    </div>

    <div
      class="relative max-w-6xl mx-auto px-5 lg:px-8 flex flex-col gap-16 sm:gap-24 py-6"
    >
      <div class="absolute top-0 bottom-0 h-full w-6 flex justify-center">
        <div class="w-0.5 bg-line h-full"></div>
      </div>
      {
        items.map(async (item) => {
          const { Content } = await item.render();
          return (
            <div class="grid grid-cols-12 gap-2 sm:gap-5">
              <div class="size-6 shrink-0 mt-1 lg:mt-2 relative">
                {item.data.status === "done" && (
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                  >
                    <g clip-path="url(#a)">
                      <path
                        fill="#1b2128"
                        stroke="#d7d9df"
                        stroke-linecap="square"
                        stroke-miterlimit="10"
                        stroke-width="2"
                        d="M12 23c6.075 0 11-4.925 11-11S18.075 1 12 1 1 5.925 1 12s4.925 11 11 11Z"
                      />
                      <path fill="#1b2128" d="m6 12 4 4 8-8" />
                      <path
                        stroke="#d7d9df"
                        stroke-linecap="square"
                        stroke-miterlimit="10"
                        stroke-width="2"
                        d="m6 12 4 4 8-8"
                      />
                    </g>
                    <defs>
                      <clipPath id="a">
                        <path fill="#fff" d="M0 0h24v24H0z" />
                      </clipPath>
                    </defs>
                  </svg>
                )}

                {/* {item.data.status === 'in-progress' && (
               <svg class="animate-spin bg-[#1F2831B2] rounded-full" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#a)"><path opacity=".4" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16ZM8 2a6 6 0 1 0 0 12A6 6 0 0 0 8 2Z" fill="#2D3843"></path><path d="M16 8h-2a6 6 0 0 0-6-6V0a8 8 0 0 1 8 8Z" fill="#D6D9DF"></path><path d="m9.98 15.73-.5-1.93a6 6 0 0 0 4.33-7.3l1.94-.5a8 8 0 0 1-5.77 9.73Z" fill="#D6D9DF"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h16v16H0z"></path></clipPath></defs></svg>

                )} */}

                {item.data.status === "in-progress" && (
                  <svg
                    class="animate-spin-1500ms"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                  >
                    <g clip-path="url(#a)">
                      <path
                        fill="#1b2128"
                        stroke="#2f3842"
                        stroke-linecap="square"
                        stroke-miterlimit="10"
                        stroke-width="2"
                        d="M12 23c6.075 0 11-4.925 11-11S18.075 1 12 1 1 5.925 1 12s4.925 11 11 11Z"
                      />
                      <path
                        fill="#d7d9df"
                        d="M24 12h-2A10.011 10.011 0 0 0 12 2V0a12.013 12.013 0 0 1 12 12Z"
                      />
                    </g>
                    <defs>
                      <clipPath id="a">
                        <path fill="#fff" d="M0 0h24v24H0z" />
                      </clipPath>
                    </defs>
                  </svg>
                )}

                {item.data.status === "to-do" && (
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                  >
                    <path
                      fill="#1b2128"
                      stroke="#2f3842"
                      stroke-linecap="square"
                      stroke-miterlimit="10"
                      stroke-width="2"
                      d="M12 23c6.075 0 11-4.925 11-11S18.075 1 12 1 1 5.925 1 12s4.925 11 11 11Z"
                    />
                  </svg>
                )}
              </div>

              <div class="col-span-10 col-start-3 sm:col-span-4 text-[#F6F7F9] text-2xl lg:text-[32px] leading-tight font-bold">
                <h3>{item.data.title}</h3>
              </div>

              <div class="col-span-10 sm:col-span-6 col-start-3 sm:col-start-7 prose text-[17px] leading-6 text-[#F6F7F9CC]">
                <Content />
              </div>
            </div>
          );
        })
      }
    </div>

    <div
      class="max-w-6xl mx-auto px-5 lg:px-8 grid grid-cols-12 gap-5 my-24 md:my-48 border border-transparent"
    >
      <div class="col-span-12 md:col-span-6">
        <h3 class="font-bold mb-2">Missing features?</h3>
        <div>
          Suggest on <a
            href="https://discord.ethswarm.org/"
            class="bg-[#2B2B2B] font-semibold text-sm py-2 px-4 rounded-full no-underline leading-[48px]"
            >Discord</a
          > or <br class="sm:hidden" />propose a <a
            href="#"
            class="bg-[#2B2B2B] font-semibold text-sm py-2 px-4 rounded-full no-underline"
            >SWIP</a
          >
        </div>
      </div>

      <div
        class="col-span-12 md:col-span-6 opacity-80 text-sm md:text-[19px] md:leading-[26px]"
      >
        <h4 class="font-bold">Disclaimer:</h4>
        <div>
          The dates and milestones outlined in this roadmap are subject to
          change.
        </div>
      </div>
    </div>
  </main>
</Layout>
